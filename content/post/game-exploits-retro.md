+++
author = "James Moriarty"
title = "Game Exploit Retrospective"
date = "2020-06-10"
description = ""
tags = [
    "go",
	"games",
	"security"
]
+++

I recently dedicated some time to explore the software security space and gain some hands-on experience through exercises like developing game exploits. I decided to write a game exploit for Valve Software's extremely popular Counter-Strike: Global Offensive primarily because of the availability of existing information.

- Source code leak from 2013 for reference.
- Lots of existing exploit examples.

When taking on projects with lots of unknown elements - I like to focus on a "steel-thread" implementation.

- Exploit functionality to be as anemic as possible.
- Exploit managed from a simple external process.
- Exploit uses the standard Win32 API.

I spent a significant amount of time reading existing exploit code which mine was based on. There has been a proliferation of open-source code available through sites like github.com. I'm finding more and more; I use github.com code search similarly to stackoverflow.com to solve programming problems.

- Exploit: https://github.com/jamesmoriarty/gohack

![Gohack](/images/gohack.jpg)

The problem with leveraging "prior-work" is that I wasn't sure how much I had learnt vs copied. This lead to the most valuable part of the exercise - extracting any generic exploit functionality into a shared library. This was the moment it started to become clear how much I had or hadn't learnt.

- Library: https://github.com/jamesmoriarty/gomem

![Gomem](/images/gomem.jpg)

Testing proved very difficult because the exploit depends on compatibility with a 3rd party binary. I spent a significate amount of the time creating stub binaries to test different failure modes. This was paid back when it came to refactoring. I also found it easier to write contrived tests for the library compared to the exploit.

![Gohack Tests](/images/gohack-test.png)

I also used this exercise to write something material with Golang which I have little experience. Despite Golang being a general-purpose programming language - I found several blog posts worth of issues with its Windows implementation.

- Golang Windows executables and DLLs are binary incompatible: https://github.com/golang/go/issues/32101
- Standard library bugs with Windows syscalls: https://github.com/golang/go/issues/34474

Overall the exercise has felt worthwhile.